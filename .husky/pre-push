branch="$(git rev-parse --abbrev-ref HEAD)"
protected_branches=("main" "develop" )

echo "ğŸ§ª Running tests before pushing..."

if ! pnpm test; then
  if printf '%s\n' "${protected_branches[@]}" | grep -q -P "^${branch}$"; then
    echo "âŒ Tests failed. Push aborted on protected $branch."
    exit 1
  else
    echo "âš ï¸ Tests failed, but push will continue on non-protected branch $branch."
  fi
else
  echo "âœ… Tests passed."
fi
